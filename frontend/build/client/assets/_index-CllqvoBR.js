import{n as j,r as u,j as r}from"./jsx-runtime-BVzQf6E0.js";import{B as I,a as C,m as b,W as E}from"./width_limit-CngMnDB3.js";import{R as g,C as y}from"./col-72kQnMqL.js";import{S as z,a as v}from"./subscription-BvSs6UUD.js";import{c as L,p as $,l as P,j as R,m as D,s as F,n as N}from"./client-c40QJxix.js";import{L as T}from"./loading-dEFtmIfz.js";import{C as _}from"./index-K5r8TNW_.js";import{S as B,P as W}from"./page_header-p8RXdD20.js";import"./index-Dm89QOQe.js";import"./index-BJsTzASz.js";import"./index-CroKYYni.js";import"./index-ICOqW_OP.js";import"./IconPlus-Cu70Nnu5.js";const M={PREFIX:`${I}`};var A=function(s,a){var n={};for(var e in s)Object.prototype.hasOwnProperty.call(s,e)&&a.indexOf(e)<0&&(n[e]=s[e]);if(s!=null&&typeof Object.getOwnPropertySymbols=="function")for(var t=0,e=Object.getOwnPropertySymbols(s);t<e.length;t++)a.indexOf(e[t])<0&&Object.prototype.propertyIsEnumerable.call(s,e[t])&&(n[e[t]]=s[e[t]]);return n};const c=M.PREFIX,X=s=>{const{layout:a="horizontal",dashed:n,align:e="center",className:t,margin:i,style:d,children:l}=s,m=A(s,["layout","dashed","align","className","margin","style","children"]),p=C(`${c}-divider`,t,{[`${c}-divider-horizontal`]:a==="horizontal",[`${c}-divider-vertical`]:a==="vertical",[`${c}-divider-dashed`]:!!n,[`${c}-divider-with-text`]:l&&a==="horizontal",[`${c}-divider-with-text-${e}`]:l&&a==="horizontal"});let o={};return i!==void 0&&(a==="vertical"?o={marginLeft:i,marginRight:i}:a==="horizontal"&&(o={marginTop:i,marginBottom:i})),j.createElement("div",Object.assign({},m,{className:p,style:Object.assign(Object.assign({},o),d)}),l&&a==="horizontal"?typeof l=="string"?j.createElement("span",{className:`${c}-divider_inner-text`,"x-semi-prop":"children"},l):l:null)},H=(s,a)=>s.reduce((n,e)=>{const t=a(e);return n[t]||(n[t]=[]),n[t].push(e),n},{}),Y=(s,a)=>{if(!s)return[];const n=Object.entries(s);return n.length===0?[]:n.reduce((e,t)=>(e.push(a(t[0],t[1])),e),[])};function k({background:s="transparent",poster_path:a,style:n,width:e,height:t,...i}){const d=`https://image.tmdb.org/t/p/w92${a}`,l=`https://image.tmdb.org/t/p/original${a}`,[m,p]=u.useState(d),[o,h]=u.useState(!0),S=O=>{const x=new Image;x.src=O,x.onload=()=>{p(x.src),h(!1)}};return u.useEffect(()=>{S(l)},[]),r.jsx("div",{style:{height:t,width:e,overflow:"hidden"},children:r.jsx("img",{style:{filter:`${o?"blur(20px)":""}`,transition:".2s filter ease",width:"100%",height:"100%",background:s,...n},src:m,...i})})}const w="47dvw - 8px";function q({meta:s}){var l;const{Text:a}=b,n=L(),[e,t]=n?[`calc(${w})`,`calc(1.5 * (${w}))`]:[230,230*1.5],i=(l=s.tv)!=null&&l.poster_path?r.jsx("a",{tabIndex:0,style:{width:e,textDecoration:"none",cursor:"pointer",zIndex:100},role:"button",href:`/meta/${s._id.$oid}`,children:r.jsx(k,{alt:"番剧封面",width:e,height:t,poster_path:s.tv.poster_path})}):null,d=s.broadcast?$(s.broadcast):{};return r.jsxs(_,{shadows:"always",bordered:!1,cover:i,style:{width:e,cursor:"unset"},bodyStyle:{maxWidth:"100%",display:"flex",flexDirection:"row",flexWrap:"nowrap",justifyContent:"space-between",padding:"15px"},children:[r.jsx(_.Meta,{style:{overflow:"hidden",textOverflow:"ellipsis"},title:r.jsx(a,{ellipsis:{showTooltip:!0},children:P(s)}),description:r.jsx(B,{children:r.jsx(a,{type:"secondary",children:R(d)})})}),r.jsx(z,{show_text:!1,meta_id:s._id.$oid,subscription:s.subscription??null})]})}const ie=()=>[{title:"New Remix App"},{name:"description",content:"Welcome to Remix!"}],f=[{value:"winter",label:"1月番"},{value:"spring",label:"4月番"},{value:"summer",label:"7月番"},{value:"fall",label:"10月番"}];function le(){var p;const a=new Date().getFullYear(),n=Math.floor((new Date().getMonth()+1)/3),e=f[n].value,[t,i]=u.useState(e),[d,l]=u.useState(a),m=Array.from({length:a-1943+1},(o,h)=>h+1943).map(o=>({value:o,label:o})).reverse();return r.jsxs(r.Fragment,{children:[r.jsxs(W,{routes:[{href:"/",name:"首页"},{name:"本季新番"}],children:[r.jsx(b.Title,{type:"secondary",style:{margin:"2em 0 1em"},children:t===e&&d===a?"本季新番":`${d}年${(p=f.find(o=>o.value===t))==null?void 0:p.label}`}),r.jsxs(g,{gutter:12,children:[r.jsx(y,{span:12,children:r.jsx(v,{placeholder:"年",style:{width:180},value:d,onSelect:o=>l(o),optionList:m})}),r.jsx(y,{span:12,children:r.jsx(v,{placeholder:"季",style:{width:180},value:t,onSelect:o=>i(o),optionList:f})})]})]}),r.jsx(T,{size:"large",useData:()=>D(d,t),children:o=>G(o)})]})}function G(s){const a=s.filter(e=>!!e.tv&&!!e.broadcast).map(e=>({...e,parsed_broadcast:$(e.broadcast)})),n=Y(H(a,e=>e.parsed_broadcast.begin.getDay()),(e,t)=>({day:e,bangumis:t})).sort((e,t)=>F(e.day,t.day));return r.jsx(r.Fragment,{children:r.jsx(E,{maxWidth:230*6+20*5,children:n.map(({day:e,bangumis:t})=>r.jsxs(r.Fragment,{children:[r.jsx(g,{children:r.jsx(X,{style:{marginTop:"2em",marginBottom:"3em"},children:r.jsxs(b.Title,{heading:4,style:{margin:"0 1em"},children:["星期",N(e)]})})},`header-${e}`),r.jsx(g,{gutter:{xs:8,sm:12,md:20},children:t==null?void 0:t.sort((i,d)=>+i.parsed_broadcast.begin-+d.parsed_broadcast.begin).map(i=>r.jsx(y,{xs:12,md:8,lg:6,xxl:4,style:{display:"flex",justifyContent:"center",marginBottom:"1em"},children:r.jsx(q,{meta:i})},i._id.$oid))},`content-${e}`)]}))})})}export{le as default,ie as meta};
